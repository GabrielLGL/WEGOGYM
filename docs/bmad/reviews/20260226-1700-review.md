# Code Review â€” 20260226-1700

## Fichiers analysÃ©s

| Fichier | Type | Verdict |
|---------|------|---------|
| `web/src/emails/welcome.tsx` | Nouveau (non-commitÃ©) | ğŸ”´ |
| `web/src/app/api/subscribe/route.ts` | Nouveau (non-commitÃ©) | ğŸŸ¡ |
| `web/src/app/layout.tsx` | Nouveau (non-commitÃ©) | âœ… |
| `mobile/run_checks.ps1` | Script utilitaire | âœ… |
| commits: databaseHelpers split (c921dcf) | Refactor mobile | âœ… |
| commits: statsHelpers split (8df202d) | Refactor mobile | âœ… |
| commits: magic numbers D (62bc142) | Refactor style | âœ… |
| commits: perf ExercisesScreen (cf9aa53) | Perf + style | âœ… |
| commits: WorkoutExerciseCard spring (310db86) | Feat mobile | âœ… |
| commits: AssistantPreviewSheet (663aa5d) | Feat mobile | âœ… |

## ProblÃ¨mes trouvÃ©s

| # | Fichier | Ligne | ProblÃ¨me | SÃ©vÃ©ritÃ© |
|---|---------|-------|----------|----------|
| 1 | `web/src/emails/welcome.tsx` | 217 | URL CTA pointe vers `kore-app-cyan.vercel.app` (staging) au lieu de `kore-app.com` (production). Les vrais inscrits reÃ§oivent un lien vers le mauvais domaine. | ğŸ”´ |
| 2 | `web/src/emails/welcome.tsx` | 253 | `href="%unsubscribe_url%"` â€” Resend ne remplace pas ce placeholder automatiquement. Les clics sur "Se dÃ©sinscrire" mÃ¨neront vers l'URL littÃ©rale. | ğŸ”´ |
| 3 | `web/src/app/api/subscribe/route.ts` | 10 | Validation email trop permissive : `includes("@")` accepte `"@"`, `"@foo"`, `"foo@"`. Pas bloquant pour une liste early-access. | ğŸŸ¡ |
| 4 | `web/src/emails/welcome.tsx` | 161 | `key={i}` dans `.map()` sur liste statique â€” fonctionnel mais non-sÃ©mantique. | ğŸŸ¡ |

## Points positifs

- Commits mobile propres : 0 erreur TypeScript, 1206+ tests passing
- Barrel pattern databaseHelpers/statsHelpers : compatibilitÃ© totale, aucun importeur cassÃ©
- Comparateur custom WatermelonDB sur `ExerciseItem.memo()` â€” nÃ©cessaire et correct (WatermelonDB mute les instances en place)
- `Animated.spring` avec `useNativeDriver: true` â€” correct pour Fabric
- `layout.tsx` : `dangerouslySetInnerHTML` sÃ©curisÃ© (JSON.stringify + try/catch thÃ¨me)
- `route.ts` : swallow Resend error sans bloquer la rÃ©ponse utilisateur â€” bon pattern

## Verdict global : CORRIGE D'ABORD ğŸ”´

## ParallÃ©lisation des corrections

| # | ProblÃ¨me | Fichier | Effort | Groupe |
|---|----------|---------|--------|--------|
| 1 | URL CTA staging â†’ production | `welcome.tsx:217` | 1 ligne | A |
| 2 | Placeholder unsubscribe non rÃ©solu | `welcome.tsx:253` | ~5 lignes | A |

ProblÃ¨mes 1 et 2 dans le mÃªme fichier â†’ sÃ©quentiel (Groupe A unique).

- **Claude Code 1 (Groupe A)** : Corriger `welcome.tsx` â€” URL + unsubscribe
