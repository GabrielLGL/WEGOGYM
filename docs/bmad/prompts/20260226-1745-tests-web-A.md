<!-- v1.0 — 2026-02-26 -->
# Rapport — Tests web — Groupe A : Setup Vitest — 20260226-1745

## Objectif
Configurer l'infrastructure de tests automatisés pour le projet `web/` (Next.js 15 + React 19).
Aucun test n'existe encore. Ce groupe installe et configure tout le nécessaire.

## Fichiers concernés
- `web/package.json` — ajouter devDependencies + script `test`
- `web/vitest.config.ts` — créer (nouveau fichier)
- `web/src/test/setup.ts` — créer (setup global jest-dom)
- `web/tsconfig.json` — ajouter les types vitest si nécessaire

## Contexte technique
- Next.js 15.1 + React 19 + TypeScript strict
- TailwindCSS 4 (pas pertinent pour les tests)
- Alias `@/*` → `./src/*` (défini dans tsconfig.json)
- Composants utilisent `"use client"` → testables avec jsdom + @testing-library/react
- Pas de tests existants côté web (mobile a Jest, web n'a rien)

## Étapes

### 1. Installer les dépendances de test
Dans `web/`, installer en devDependencies :
```bash
npm install --save-dev vitest @vitejs/plugin-react @testing-library/react @testing-library/user-event @testing-library/jest-dom jsdom
```

### 2. Créer `web/vitest.config.ts`
```ts
import { defineConfig } from 'vitest/config'
import react from '@vitejs/plugin-react'
import path from 'path'

export default defineConfig({
  plugins: [react()],
  test: {
    environment: 'jsdom',
    setupFiles: ['./src/test/setup.ts'],
    globals: true,
  },
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src'),
    },
  },
})
```

### 3. Créer `web/src/test/setup.ts`
```ts
import '@testing-library/jest-dom'
```

### 4. Modifier `web/package.json` — ajouter scripts
Dans la section `"scripts"`, ajouter :
```json
"test": "vitest run",
"test:watch": "vitest"
```

### 5. Vérifier l'alias TypeScript
Dans `web/tsconfig.json`, l'alias `@/*` existe déjà (`"paths": { "@/*": ["./src/*"] }`).
Ajouter dans `"types"` si besoin : `"vitest/globals"` — ou ajouter un fichier `web/src/test/vitest.d.ts` :
```ts
/// <reference types="vitest/globals" />
```

### 6. Valider le setup avec un test smoke
Créer `web/src/test/smoke.test.ts` :
```ts
import { describe, it, expect } from 'vitest'

describe('setup', () => {
  it('vitest fonctionne', () => {
    expect(1 + 1).toBe(2)
  })
})
```
Lancer `npm test` depuis `web/` → doit passer en vert.

## Contraintes
- Ne pas modifier la config Next.js (`next.config.ts`, etc.)
- Ne pas modifier les fichiers source existants
- Vitest doit être en devDependencies uniquement
- L'alias `@/` doit fonctionner dans les tests (résolution via vitest.config.ts)

## Critères de validation
- `npm test` (depuis `web/`) → au moins 1 test passe (smoke test)
- `npm run build` (depuis `web/`) → toujours sans erreur (setup n'affecte pas le build)
- `npx tsc --noEmit` (depuis `web/`) → zéro erreur TypeScript

## Dépendances
Aucune dépendance — ce groupe est la base pour B, C et D.

## Statut
✅ Résolu — 20260226-1156

## Résolution
Rapport do : docs/bmad/do/20260226-1156-test-web-setup-vitest.md
