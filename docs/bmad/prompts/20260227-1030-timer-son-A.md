<!-- v1.0 — 2026-02-27 -->
# Rapport — timer-son — Groupe A (DB) — 20260227-1030

## Objectif
Ajouter deux nouvelles préférences utilisateur dans la DB : `vibrationEnabled` et `timerSoundEnabled`. Ces booléens contrôleront si le timer de repos déclenche une vibration et/ou un son à la fin.

## Fichiers concernés
- `mobile/src/model/schema.ts`
- `mobile/src/model/models/User.ts`

## Contexte technique
- WatermelonDB schéma **v24** (fichier : `mobile/src/model/schema.ts`, ligne 4 : `version: 24`)
- Pas de fichier migrations — un bump de version suffit (WatermelonDB reconstruit la DB)
- Modèle User : `mobile/src/model/models/User.ts` — pattern `@field('nom_colonne') nomProp!: boolean`
- Toujours synchroniser schema.ts ↔ User.ts (CLAUDE.md règle Known Pitfalls)
- Le patron existant pour les booléens : `{ name: 'timer_enabled', type: 'boolean' }` dans le schema et `@field('timer_enabled') timerEnabled!: boolean` dans le modèle

## Étapes

### 1. schema.ts — bump version + 2 colonnes
Dans la table `users`, ajouter après `{ name: 'timer_enabled', type: 'boolean' }` :
```typescript
{ name: 'vibration_enabled', type: 'boolean' },
{ name: 'timer_sound_enabled', type: 'boolean' },
```
Modifier la ligne `version: 24` → `version: 25` (et mettre à jour le commentaire).

### 2. User.ts — 2 nouveaux @field
Ajouter après `@field('timer_enabled') timerEnabled!: boolean` :
```typescript
@field('vibration_enabled') vibrationEnabled!: boolean
@field('timer_sound_enabled') timerSoundEnabled!: boolean
```

## Contraintes
- Ne pas casser : tous les autres champs existants du modèle User et du schema users
- Respecter : `@field` pour boolean (pas `@text`), synchronisation schema ↔ model stricte
- Ne pas introduire de `any`

## Critères de validation
- `npx tsc --noEmit` → zéro erreur
- `npm test` → zéro fail
- Vérifier manuellement : `schema.ts` version = 25, 2 nouvelles colonnes dans users, `User.ts` 2 nouveaux @field

## Dépendances
Aucune dépendance sur les autres groupes.

## Statut
✅ Résolu — 20260227-1030

## Résolution
Rapport do : docs/bmad/do/20260227-1030-feat-db-timer-preferences.md
