<!-- v1.0 ‚Äî 2026-02-26 -->
# Rapport ‚Äî react-native-shadow-2 ‚Äî Groupe B ‚Äî 20260226-2100

## Objectif
Migrer les deux composants les plus visibles de l'app vers le vrai neumorphisme double-ombre
en utilisant le composant `NeuShadow` cr√©√© par le Groupe A :

1. **`Button.tsx`** : remplacer `neuShadow.*` ViewStyle par wrapper `<NeuShadow>` +
   gestion du state `isPressed` via `onPressIn`/`onPressOut`
2. **`SettingsScreen.tsx`** : wraper les 8 sections cards avec `<NeuShadow level="elevatedSm">`

**D√©pend de** : Groupe A (`NeuShadow.tsx` et `neuShadowParams` doivent exister).

## Fichiers concern√©s
1. `mobile/src/components/Button.tsx`
2. `mobile/src/screens/SettingsScreen.tsx`

## Contexte technique
- `NeuShadow` se trouve dans `mobile/src/components/NeuShadow.tsx`
- Props NeuShadow : `level` ('elevated'|'elevatedSm'|'pressed'), `radius`, `style` (containerStyle),
  `stretch` (alignSelf stretch), `disabled`
- `useTheme()` depuis `contexts/ThemeContext` retourne `{ colors, neuShadow, isDark, toggleTheme, ... }`
- Le `neuShadow` legacy (ViewStyle spread) reste disponible pour les √©l√©ments non migr√©s
- **Fabric crash** : jamais `<Modal>` natif ‚Äî uniquement Portal (d√©j√† respect√© dans ces fichiers)
- `borderRadius.sm` = 10 (boutons), `borderRadius.md` = 14 (sections)
- `spacing.lg` = 24 (margin entre sections)

## √âtapes

### Fichier 1 : `mobile/src/components/Button.tsx`

Lire le fichier en entier avant de modifier.

#### Changements
1. Ajouter `import { useState } from 'react'`
2. Ajouter `import { NeuShadow } from './NeuShadow'`
3. Retirer `neuShadow` du destructuring `useTheme()` (il n'est plus utilis√©)
4. Ajouter `const [isPressed, setIsPressed] = useState(false)` dans le composant
5. Sur le `<Pressable>` :
   - Retirer le spread `neuShadow.*` du style (la fonction `({ pressed }) => [...]`)
   - Ajouter `onPressIn={() => setIsPressed(true)}`
   - Ajouter `onPressOut={() => setIsPressed(false)}`
   - Garder `pressed` dans la fonction render pour la logique du gradient `primary`
6. Pour le return :
   - Si `variant === 'ghost'` ‚Üí retourner le Pressable directement (pas de NeuShadow)
   - Sinon ‚Üí wrapper le Pressable dans `<NeuShadow>`

Pattern final du return :
```tsx
if (variant === 'ghost') {
  return pressable
}

return (
  <NeuShadow
    level={isPressed ? 'pressed' : 'elevated'}
    radius={borderRadius.sm}
    stretch={fullWidth}
    style={style}
    disabled={disabled}
  >
    {pressable}
  </NeuShadow>
)
```

Le `pressable` est le `<Pressable>` avec ses styles internes (base, size, variant, fullWidth, disabled).
Le `style` prop externe va au `containerStyle` de NeuShadow (pour les margins externes).

### Fichier 2 : `mobile/src/screens/SettingsScreen.tsx`

Lire le fichier en entier avant de modifier.

#### Changements
1. Ajouter `import { NeuShadow } from '../components/NeuShadow'`
2. Dans `useTheme()` : garder `neuShadow` ‚Äî il est encore utilis√© pour `streakTargetBtn`,
   `streakTargetBtnActive`, `exportButton`
3. Dans `StyleSheet.create` : dans le style `section`, retirer `marginBottom: spacing.lg`
   et retirer `...neuShadow.elevatedSm` (le shadow passe au NeuShadow wrapper)
4. Wrapper chacune des **8 sections** `<View style={styles.section}>` avec :
```tsx
<NeuShadow level="elevatedSm" radius={borderRadius.md} style={{ marginBottom: spacing.lg }}>
  <View style={styles.section}>
    {/* contenu inchang√© */}
  </View>
</NeuShadow>
```

Les 8 sections √† wrapper (dans l'ordre d'apparition) :
- üë§ Mon profil
- üé® Apparence
- ‚è±Ô∏è Minuteur de repos
- ‚≠ê Gamification
- ‚ú® Intelligence Artificielle
- üíæ Donn√©es
- ‚ÑπÔ∏è √Ä propos
- ‚ùì Aide

**Important** : le `marginBottom` doit aller sur le `NeuShadow`, PAS sur le `View` interne ‚Äî
sinon les ombres sont coup√©es par le margin.

### Validation finale
```bash
cd mobile && npx tsc --noEmit
cd mobile && npm test -- --passWithNoTests
```

## Contraintes
- Ne pas modifier la logique m√©tier (WatermelonDB, withObservables, handlers)
- `streakTargetBtn`, `streakTargetBtnActive`, `exportButton` gardent `...neuShadow.*` legacy
- Ne pas ajouter `console.log`
- Aucun `any` TypeScript
- Garder le `pressed` render prop de Pressable pour la logique du gradient primary
- `fullWidth` : utiliser `stretch={fullWidth}` sur NeuShadow (pas `width: '100%'` sur le container)

## Crit√®res de validation
- `cd mobile && npx tsc --noEmit` ‚Üí z√©ro erreur
- `npm test` ‚Üí SettingsScreen.test.tsx PASS
- Visuellement (device/emu) : sections SettingsScreen avec 2 ombres douces sur coins oppos√©s
- Dark theme + Light theme toggle ‚Üí ombres s'adaptent automatiquement
- Button secondary/danger : ombre NeuShadow visible + dispara√Æt l√©g√®rement au press

## D√©pendances
Ce groupe d√©pend de **Groupe A** (`NeuShadow.tsx` + `neuShadowParams` dans theme + `react-native-shadow-2` install√©).

## Statut
‚úÖ R√©solu ‚Äî 20260226-2100

## R√©solution
Rapport do : docs/bmad/do/20260226-2100-style-neu-shadow-2-neumorphism.md
