<!-- v1.0 — 2026-02-26 -->
# Rapport — react-native-shadow-2 — Groupe A — 20260226-2100

## Objectif
Implémenter l'infrastructure du vrai neumorphisme double-ombre via `react-native-shadow-2` :
1. Installer la dépendance (SVG déjà présent, 0 rebuild natif)
2. Créer le composant `NeuShadow.tsx` (2 Shadow SVG imbriqués)
3. Ajouter les tokens `neuShadowParams` dans le thème
4. Corriger `lightColors` : `card === background` (prérequis absolu du neumorphisme)

**Problème actuel** : `neuShadow` = 1 ombre + `borderColor` dur → approximation. React Native
ne supporte qu'1 ombre native par View. `react-native-shadow-2` rend via SVG → 2 ombres
vraiment opposées (dark bas-droite + light haut-gauche).

**Contrainte design critique** : pour que le neumorphisme fonctionne, `card.backgroundColor`
DOIT être identique à `background`. L'effet "extrudé du matériau" n'existe que si l'élément
et l'écran ont la même couleur de fond.

## Fichiers concernés
- `mobile/package.json` — ajout `react-native-shadow-2`
- `mobile/src/components/NeuShadow.tsx` — nouveau composant
- `mobile/src/theme/index.ts` — ajout `neuShadowParams`, correction `lightColors`

## Contexte technique
- `react-native-svg@15.8.0` est déjà installé → `react-native-shadow-2` fonctionne sans rebuild
- API Shadow v7 : `style` pour corner radii, `containerStyle` pour layout externe,
  `stretch` pour alignSelf stretch, `offset=[x,y]` pour décalage directionnel
- `paintInside={false}` requis : évite que la couleur d'ombre remplisse l'intérieur
- `ThemeContext.tsx` expose `useTheme()` qui retourne `{ mode, colors, neuShadow, isDark, ... }`
- `neuShadowParams` n'est PAS dans le contexte — c'est un export statique du theme

## Étapes

### 1. Installer react-native-shadow-2
```bash
cd mobile && npm install react-native-shadow-2
```
Vérifier : `"react-native-shadow-2"` dans `mobile/package.json` dependencies.

### 2. Ajouter `neuShadowParams` dans `mobile/src/theme/index.ts`
Ajouter AVANT la ligne `/** Type union des deux palettes */` :
```typescript
/**
 * Paramètres numériques pour react-native-shadow-2 (vrai neumorphisme double-ombre)
 * distance : taille du flou SVG, offset : décalage de l'ombre (bas-droite / haut-gauche)
 */
export const neuShadowParams = {
  dark: {
    elevated:   { distance: 14, offset: 10, darkColor: '#060809', lightColor: '#3c4558' },
    elevatedSm: { distance: 8,  offset: 6,  darkColor: '#060809', lightColor: '#3c4558' },
    pressed:    { distance: 3,  offset: 2,  darkColor: '#060809', lightColor: '#2a3040' },
  },
  light: {
    elevated:   { distance: 14, offset: 10, darkColor: '#8a9bb0', lightColor: '#ffffff' },
    elevatedSm: { distance: 8,  offset: 6,  darkColor: '#8a9bb0', lightColor: '#ffffff' },
    pressed:    { distance: 3,  offset: 2,  darkColor: '#a0aabb', lightColor: '#ffffff' },
  },
}
```

### 3. Corriger `lightColors` dans `mobile/src/theme/index.ts`
Mettre `background` et `card` identiques (prérequis neumorphisme) + mettre à jour les gradients :
```typescript
// Avant :
background: '#dde3ea',
card: '#edf1f5',
// ...
bgGradientStart: '#dde3ea',
bgGradientEnd: '#cdd5de',
cardGradientStart: '#eaeff5',
cardGradientEnd: '#d8dfe8',

// Après :
background: '#e8ecef',
card: '#e8ecef',        // identique à background
// ...
bgGradientStart: '#eaeff5',
bgGradientEnd: '#dce4ee',
cardGradientStart: '#edf1f5',
cardGradientEnd: '#dde5ee',
```

### 4. Créer `mobile/src/components/NeuShadow.tsx`
```tsx
import React from 'react'
import type { StyleProp, ViewStyle } from 'react-native'
import { Shadow } from 'react-native-shadow-2'
import { useTheme } from '../contexts/ThemeContext'
import { neuShadowParams, borderRadius as defaultBorderRadius } from '../theme'

type NeuShadowLevel = 'elevated' | 'elevatedSm' | 'pressed'

interface NeuShadowProps {
  level?: NeuShadowLevel
  children: React.ReactNode
  style?: StyleProp<ViewStyle>
  radius?: number
  disabled?: boolean
  stretch?: boolean
}

export const NeuShadow: React.FC<NeuShadowProps> = ({
  level = 'elevated',
  children,
  style,
  radius = defaultBorderRadius.md,
  disabled = false,
  stretch = false,
}) => {
  const { mode } = useTheme()

  if (disabled) {
    return <>{children}</>
  }

  const params = neuShadowParams[mode][level]
  const cornerStyle: ViewStyle = { borderRadius: radius }

  return (
    <Shadow
      distance={params.distance}
      offset={[params.offset, params.offset]}
      startColor={params.darkColor}
      endColor="transparent"
      style={cornerStyle}
      containerStyle={style}
      stretch={stretch}
      paintInside={false}
    >
      <Shadow
        distance={params.distance}
        offset={[-params.offset, -params.offset]}
        startColor={params.lightColor}
        endColor="transparent"
        style={cornerStyle}
        paintInside={false}
      >
        {children}
      </Shadow>
    </Shadow>
  )
}
```

### 5. Valider TypeScript
```bash
cd mobile && npx tsc --noEmit
```
Zéro erreur attendu.

## Contraintes
- Ne pas modifier `neuShadow` ni `neuShadowLight` (rétrocompatibilité avec les composants non migrés)
- Ne pas modifier `colors` (dark theme) — seulement `lightColors`
- `paintInside={false}` est obligatoire sur les deux Shadow imbriqués
- Pas de `any` TypeScript

## Critères de validation
- `cd mobile && npx tsc --noEmit` → zéro erreur
- `NeuShadow` importable depuis `../components/NeuShadow`
- `neuShadowParams` exporté depuis `../theme`
- `lightColors.background === lightColors.card === '#e8ecef'`

## Dépendances
Aucune — ce groupe est indépendant. Le Groupe B en dépend.

## Statut
✅ Résolu — 20260226-2100

## Résolution
Rapport do : docs/bmad/do/20260226-2100-style-neu-shadow-2-neumorphism.md
