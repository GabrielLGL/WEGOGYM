<!-- v1.0 — 2026-02-28 -->
# Rapport — coverage composants + context — Groupe D — 20260228-1500

## Objectif
Ajouter des tests pour BadgeCelebration, BadgeCard et ThemeContext.

## Fichiers concernés
- `mobile/src/components/BadgeCelebration.tsx`
- `mobile/src/components/BadgeCard.tsx`
- `mobile/src/contexts/ThemeContext.tsx`

## Tests créés
- `mobile/src/components/__tests__/BadgeCelebration.test.tsx`
- `mobile/src/components/__tests__/BadgeCard.test.tsx`
- `mobile/src/contexts/__tests__/ThemeContext.test.tsx`

## Patterns clés appliqués

### BadgeCelebration — timer leak
`Animated.timing` fire des timers après teardown Jest → `ReferenceError: You are trying to access a property or method of the Jest environment after it has been torn down`.
Fix : fake timers par test.
```tsx
beforeEach(() => { jest.useFakeTimers() })
afterEach(() => { jest.useRealTimers() })
```

### ThemeContext — moduleNameMapper
`jest.config.js` mappe `'.*\/contexts\/ThemeContext'` → `ThemeContextMock.ts`.
Depuis `src/contexts/__tests__/`, l'import `'../ThemeContext'` ne contient PAS `/contexts/ThemeContext`
→ charge le vrai fichier → crash SQLiteAdapter.
Fix : import `'../../contexts/ThemeContext'` (chemin qui CONTIENT `/contexts/ThemeContext`).

### BottomSheet visible=false
Quand `visible=false`, BottomSheet ne monte PAS ses enfants → `queryByText()` doit retourner `null`.

## Statut
✅ Complété — 94 suites, 1564 tests, 0 fail
